import{R as v,u as Z,r as M,j as a,a as C}from"./index-Bngez1jy.js";import{u as ee,a as te,b as ie,i as w,c as ae,d as re,e as I,w as K,g as X,f as J,h as q,C as Q,j as ne,R as F,A as se,X as T,Y as B,T as G,k as H,B as V,l as oe}from"./AreaChart-CKL7HzMx.js";import{B as le,P as ce,a as de}from"./PieChart-Txw5eD52.js";var he=["x1","y1","x2","y2","key"],ue=["offset"];function S(e){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(e)}function R(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),s.push.apply(s,r)}return s}function g(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?R(Object(s),!0).forEach(function(r){fe(e,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):R(Object(s)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))})}return e}function fe(e,t,s){return t=me(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function me(e){var t=xe(e,"string");return S(t)=="symbol"?t:t+""}function xe(e,t){if(S(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var r=s.call(e,t||"default");if(S(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},k.apply(this,arguments)}function Y(e,t){if(e==null)return{};var s=ye(e,t),r,o;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)r=c[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function ye(e,t){if(e==null)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}var ve=function(t){var s=t.fill;if(!s||s==="none")return null;var r=t.fillOpacity,o=t.x,c=t.y,h=t.width,f=t.height,u=t.ry;return v.createElement("rect",{x:o,y:c,ry:u,width:h,height:f,stroke:"none",fill:s,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function U(e,t){var s;if(v.isValidElement(e))s=v.cloneElement(e,t);else if(I(e))s=e(t);else{var r=t.x1,o=t.y1,c=t.x2,h=t.y2,f=t.key,u=Y(t,he),d=ne(u,!1);d.offset;var i=Y(d,ue);s=v.createElement("line",k({},i,{x1:r,y1:o,x2:c,y2:h,fill:"none",key:f}))}return s}function ge(e){var t=e.x,s=e.width,r=e.horizontal,o=r===void 0?!0:r,c=e.horizontalPoints;if(!o||!c||!c.length)return null;var h=c.map(function(f,u){var d=g(g({},e),{},{x1:t,y1:f,x2:t+s,y2:f,key:"line-".concat(u),index:u});return U(o,d)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function pe(e){var t=e.y,s=e.height,r=e.vertical,o=r===void 0?!0:r,c=e.verticalPoints;if(!o||!c||!c.length)return null;var h=c.map(function(f,u){var d=g(g({},e),{},{x1:f,y1:t,x2:f,y2:t+s,key:"line-".concat(u),index:u});return U(o,d)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function be(e){var t=e.horizontalFill,s=e.fillOpacity,r=e.x,o=e.y,c=e.width,h=e.height,f=e.horizontalPoints,u=e.horizontal,d=u===void 0?!0:u;if(!d||!t||!t.length)return null;var i=f.map(function(n){return Math.round(n+o-o)}).sort(function(n,l){return n-l});o!==i[0]&&i.unshift(0);var m=i.map(function(n,l){var y=!i[l+1],p=y?o+h-n:i[l+1]-n;if(p<=0)return null;var x=l%t.length;return v.createElement("rect",{key:"react-".concat(l),y:n,x:r,height:p,width:c,stroke:"none",fill:t[x],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},m)}function je(e){var t=e.vertical,s=t===void 0?!0:t,r=e.verticalFill,o=e.fillOpacity,c=e.x,h=e.y,f=e.width,u=e.height,d=e.verticalPoints;if(!s||!r||!r.length)return null;var i=d.map(function(n){return Math.round(n+c-c)}).sort(function(n,l){return n-l});c!==i[0]&&i.unshift(0);var m=i.map(function(n,l){var y=!i[l+1],p=y?c+f-n:i[l+1]-n;if(p<=0)return null;var x=l%r.length;return v.createElement("rect",{key:"react-".concat(l),x:n,y:h,width:p,height:u,stroke:"none",fill:r[x],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}var we=function(t,s){var r=t.xAxis,o=t.width,c=t.height,h=t.offset;return X(J(g(g(g({},Q.defaultProps),r),{},{ticks:q(r,!0),viewBox:{x:0,y:0,width:o,height:c}})),h.left,h.left+h.width,s)},Oe=function(t,s){var r=t.yAxis,o=t.width,c=t.height,h=t.offset;return X(J(g(g(g({},Q.defaultProps),r),{},{ticks:q(r,!0),viewBox:{x:0,y:0,width:o,height:c}})),h.top,h.top+h.height,s)},z={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function $(e){var t,s,r,o,c,h,f=ee(),u=te(),d=ie(),i=g(g({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:z.stroke,fill:(s=e.fill)!==null&&s!==void 0?s:z.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:z.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:z.horizontalFill,vertical:(c=e.vertical)!==null&&c!==void 0?c:z.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:z.verticalFill,x:w(e.x)?e.x:d.left,y:w(e.y)?e.y:d.top,width:w(e.width)?e.width:d.width,height:w(e.height)?e.height:d.height}),m=i.x,n=i.y,l=i.width,y=i.height,p=i.syncWithTicks,x=i.horizontalValues,P=i.verticalValues,b=ae(),O=re();if(!w(l)||l<=0||!w(y)||y<=0||!w(m)||m!==+m||!w(n)||n!==+n)return null;var j=i.verticalCoordinatesGenerator||we,W=i.horizontalCoordinatesGenerator||Oe,N=i.horizontalPoints,A=i.verticalPoints;if((!N||!N.length)&&I(W)){var L=x&&x.length,E=W({yAxis:O?g(g({},O),{},{ticks:L?x:O.ticks}):void 0,width:f,height:u,offset:d},L?!0:p);K(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(S(E),"]")),Array.isArray(E)&&(N=E)}if((!A||!A.length)&&I(j)){var _=P&&P.length,D=j({xAxis:b?g(g({},b),{},{ticks:_?P:b.ticks}):void 0,width:f,height:u,offset:d},_?!0:p);K(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(S(D),"]")),Array.isArray(D)&&(A=D)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(ve,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),v.createElement(ge,k({},i,{offset:d,horizontalPoints:N,xAxis:b,yAxis:O})),v.createElement(pe,k({},i,{offset:d,verticalPoints:A,xAxis:b,yAxis:O})),v.createElement(be,k({},i,{horizontalPoints:N})),v.createElement(je,k({},i,{verticalPoints:A})))}$.displayName="CartesianGrid";const ze=()=>{const{t:e,transactions:t,getCat:s,catLabel:r,lang:o}=Z(),c=M.useMemo(()=>{const i={},m=new Date;for(let n=6;n>=0;n--){const l=new Date(m);l.setDate(l.getDate()-n);const y=l.toISOString().slice(0,10),p=o==="ru"?["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]:o==="uz"?["Ya","Du","Se","Ch","Pa","Ju","Sh"]:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];i[y]={date:y,expenses:0,income:0,label:p[l.getDay()]}}return t.forEach(n=>{i[n.date]&&(n.amount<0?i[n.date].expenses+=Math.abs(n.amount):i[n.date].income+=n.amount)}),Object.values(i)},[t,o]),h=M.useMemo(()=>{const i=[],m=new Date;for(let n=3;n>=0;n--){const l=new Date(m);l.setDate(l.getDate()-n*7-6);const y=new Date(m);y.setDate(y.getDate()-n*7);const p=l.toISOString().slice(0,10),x=y.toISOString().slice(0,10);let P=0,b=0;t.forEach(j=>{j.date>=p&&j.date<=x&&(j.amount<0?P+=Math.abs(j.amount):b+=j.amount)});const O=o==="ru"?`Нед ${4-n}`:o==="uz"?`Hafta ${4-n}`:`Week ${4-n}`;i.push({week:O,expenses:P,income:b})}return i},[t,o]),f=M.useMemo(()=>{const i={},m=new Date().toISOString().slice(0,7);return t.forEach(n=>{if(n.amount<0&&n.date.startsWith(m)){if(!i[n.categoryId]){const l=s(n.categoryId);i[n.categoryId]={id:n.categoryId,value:0,color:l.color}}i[n.categoryId].value+=Math.abs(n.amount)}}),Object.values(i).sort((n,l)=>l.value-n.value).slice(0,6).map(n=>({...n,name:r(s(n.id))}))},[t,s,r]),u=M.useMemo(()=>{const i=new Date().toISOString().slice(0,7),m=new Date(new Date().setMonth(new Date().getMonth()-1)).toISOString().slice(0,7);let n=0,l=0,y=0;t.forEach(x=>{x.date.startsWith(i)?x.amount<0?n+=Math.abs(x.amount):y+=x.amount:x.date.startsWith(m)&&x.amount<0&&(l+=Math.abs(x.amount))});const p=l>0?(n-l)/l*100:0;return{thisMonthExp:n,thisMonthInc:y,change:p}},[t]),d=i=>i>=1e6?`${(i/1e6).toFixed(1)}M`:i>=1e3?`${(i/1e3).toFixed(0)}K`:i.toString();return a.jsxs("div",{className:"screen-container pb-32",children:[a.jsxs("div",{className:"safe-top px-4 pt-4 pb-6",children:[a.jsx("h1",{className:"text-title-1 text-foreground",children:e.analytics}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e.monthSpending})]}),a.jsx("div",{className:"px-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card p-4",children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:e.expenses}),a.jsxs("p",{className:"text-xl font-bold text-expense",children:["-",d(u.thisMonthExp)]}),u.change!==0&&a.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs ${u.change>0?"text-expense":"text-income"}`,children:[a.jsx("span",{children:u.change>0?"↑":"↓"}),a.jsxs("span",{children:[Math.abs(u.change).toFixed(0),"%"]})]})]}),a.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"glass-card p-4",children:[a.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:e.income}),a.jsxs("p",{className:"text-xl font-bold text-income",children:["+",d(u.thisMonthInc)]})]})]})}),a.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"px-4 mb-6",children:a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-4",children:e.weekSpending}),a.jsx("div",{className:"h-48",children:a.jsx(F,{width:"100%",height:"100%",children:a.jsxs(se,{data:c,margin:{top:5,right:5,left:-20,bottom:5},children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:"expenseGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"hsl(var(--expense))",stopOpacity:.3}),a.jsx("stop",{offset:"95%",stopColor:"hsl(var(--expense))",stopOpacity:0})]}),a.jsxs("linearGradient",{id:"incomeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"hsl(var(--income))",stopOpacity:.3}),a.jsx("stop",{offset:"95%",stopColor:"hsl(var(--income))",stopOpacity:0})]})]}),a.jsx($,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.5}),a.jsx(T,{dataKey:"label",axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:11}}),a.jsx(B,{axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:10},tickFormatter:d}),a.jsx(G,{contentStyle:{background:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},formatter:i=>[d(i),""]}),a.jsx(H,{type:"monotone",dataKey:"expenses",stroke:"hsl(var(--expense))",strokeWidth:2,fill:"url(#expenseGradient)",name:e.expenses}),a.jsx(H,{type:"monotone",dataKey:"income",stroke:"hsl(var(--income))",strokeWidth:2,fill:"url(#incomeGradient)",name:e.income})]})})})]})}),a.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"px-4 mb-6",children:a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-4",children:e.monthSpending}),a.jsx("div",{className:"h-48",children:a.jsx(F,{width:"100%",height:"100%",children:a.jsxs(le,{data:h,margin:{top:5,right:5,left:-20,bottom:5},children:[a.jsx($,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.5}),a.jsx(T,{dataKey:"week",axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:11}}),a.jsx(B,{axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:10},tickFormatter:d}),a.jsx(G,{contentStyle:{background:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},formatter:i=>[d(i),""]}),a.jsx(V,{dataKey:"expenses",fill:"hsl(var(--expense))",radius:[4,4,0,0],name:e.expenses}),a.jsx(V,{dataKey:"income",fill:"hsl(var(--income))",radius:[4,4,0,0],name:e.income})]})})})]})}),a.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"px-4 mb-6",children:a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-4",children:e.topCategories}),f.length>0?a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-36 h-36",children:a.jsx(F,{width:"100%",height:"100%",children:a.jsxs(ce,{children:[a.jsx(de,{data:f,cx:"50%",cy:"50%",innerRadius:35,outerRadius:55,paddingAngle:3,dataKey:"value",children:f.map((i,m)=>a.jsx(oe,{fill:i.color},`cell-${m}`))}),a.jsx(G,{contentStyle:{background:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"12px"},formatter:i=>[d(i),""]})]})})}),a.jsx("div",{className:"flex-1 space-y-2",children:f.map(i=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:i.color}}),a.jsx("span",{className:"text-xs text-foreground truncate flex-1",children:i.name}),a.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:d(i.value)})]},i.id))})]}):a.jsx("div",{className:"py-8 text-center text-muted-foreground text-sm",children:e.empty})]})})]})};export{ze as AnalyticsScreen,ze as default};
