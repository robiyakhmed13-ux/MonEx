import{r as n,u as Z,j as e,a as y,T as $,C as M,f as C,c as k}from"./index-Bngez1jy.js";import{A as B}from"./arrow-left-BXUsCCoW.js";const F=n.memo(()=>{var f;const{t:s,limits:o,allCats:i,getCat:w,catLabel:h,monthSpentByCategory:S,addLimit:I,updateLimit:L,deleteLimit:A,setActiveScreen:E}=Z(),[d,p]=n.useState(null),[l,m]=n.useState(((f=i.expense[0])==null?void 0:f.id)||"food"),[g,x]=n.useState(""),[u,c]=n.useState(null),D=()=>{const t=Number(g);!l||!t||(d?L(d,{categoryId:l,amount:t}):I({categoryId:l,amount:t}),j())},j=()=>{var t;p(null),m(((t=i.expense[0])==null?void 0:t.id)||"food"),x("")},T=t=>{p(t.id),m(t.categoryId),x(String(t.amount))},U=()=>{u&&(A(u),c(null))};return e.jsxs("div",{className:"screen-container pb-32 safe-top",children:[e.jsxs("div",{className:"px-4 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(y.button,{whileTap:{scale:.9},onClick:()=>E("home"),className:"w-10 h-10 rounded-full bg-secondary flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-title-1 text-foreground",children:s.limits}),e.jsxs("p",{className:"text-caption text-muted-foreground",children:[o.length," ",s.limits.toLowerCase()]})]})]}),e.jsx("div",{className:"space-y-3 mb-6",children:o.length===0?e.jsxs("div",{className:"card-elevated p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-2xl bg-primary/10 flex items-center justify-center",children:e.jsx($,{className:"w-8 h-8 text-primary"})}),e.jsx("p",{className:"text-muted-foreground",children:s.noLimits})]}):o.map(t=>{const a=w(t.categoryId),N=S(t.categoryId),r=t.amount?Math.round(N/t.amount*100):0,b=r>=100,v=r>=80;return e.jsxs("div",{className:"card-elevated p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"category-icon",style:{backgroundColor:`${a.color}20`},children:e.jsx(M,{categoryId:a.id,className:"w-5 h-5",style:{color:a.color}})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:h(a)}),e.jsxs("p",{className:"text-caption text-muted-foreground",children:[C(N)," / ",C(t.amount)," UZS"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-title-2 font-bold ${b?"text-expense":v?"text-warning":"text-income"}`,children:[k(r,0,999),"%"]}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("button",{onClick:()=>T(t),className:"text-2xs px-2 py-1 rounded-lg bg-accent text-primary font-medium",children:s.edit}),e.jsx("button",{onClick:()=>c(t.id),className:"text-2xs px-2 py-1 rounded-lg bg-red-50 text-expense font-medium",children:s.delete})]})]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx(y.div,{className:"progress-fill",style:{backgroundColor:b?"hsl(var(--expense))":v?"hsl(var(--warning))":a.color},initial:{width:0},animate:{width:`${k(r,0,100)}%`},transition:{duration:.5}})})]},t.id)})}),e.jsxs("div",{className:"card-elevated p-4",children:[e.jsx("h3",{className:"text-title-3 text-foreground mb-4",children:d?s.edit:s.add}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-caption text-muted-foreground font-medium mb-2 block",children:s.category}),e.jsx("select",{value:l,onChange:t=>m(t.target.value),className:"input-clean",children:i.expense.map(t=>e.jsx("option",{value:t.id,children:h(t)},t.id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-caption text-muted-foreground font-medium mb-2 block",children:[s.amount," (UZS)"]}),e.jsx("input",{value:g,onChange:t=>x(t.target.value.replace(/[^\d]/g,"")),type:"text",inputMode:"numeric",className:"input-clean",placeholder:"500000"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:j,className:"btn-secondary flex-1",children:s.cancel}),e.jsx("button",{onClick:D,className:"btn-primary flex-1",children:s.save})]})]})]}),u&&e.jsx("div",{className:"modal-overlay",onClick:()=>c(null),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 modal-content safe-bottom",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{className:"text-title-2 text-foreground mb-4",children:s.confirmDelete}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>c(null),className:"btn-secondary flex-1",children:s.cancel}),e.jsx("button",{onClick:U,className:"flex-1 py-4 rounded-xl bg-destructive text-destructive-foreground font-semibold",children:s.delete})]})]})})]})});F.displayName="LimitsScreen";export{F as LimitsScreen};
