import{b as W,r as l,u as U,g as E,j as e,a as d,P as V,J as L,Z as ee,p as N,x as te,T as ae,X as se}from"./index-Bngez1jy.js";import{R as re,A as ne,X as oe,Y as le,T as ie,k as de}from"./AreaChart-CKL7HzMx.js";import{T as ce}from"./trash-2-DgMVlkGx.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=W("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]),be=l.memo(()=>{const{lang:t,currency:p,setActiveScreen:$,showToast:z}=U(),[c,K]=l.useState(()=>E.get("hamyon_debts",[])),[x,M]=l.useState("avalanche"),[D,G]=l.useState(""),[J,f]=l.useState(!1),[y,P]=l.useState(""),[A,C]=l.useState(""),[g,T]=l.useState(""),[v,q]=l.useState(""),[w,R]=l.useState(""),s={title:t==="ru"?"План погашения долга":t==="uz"?"Qarzni to'lash rejasi":"Debt Payoff Plan",strategy:t==="ru"?"Стратегия":t==="uz"?"Strategiya":"Strategy",snowball:t==="ru"?"Снежный ком":t==="uz"?"Qor bo'roni":"Snowball",snowballDesc:t==="ru"?"Сначала мелкие долги (мотивация)":t==="uz"?"Avval kichik qarzlar":"Smallest debts first (motivation)",avalanche:t==="ru"?"Лавина":t==="uz"?"Ko'chki":"Avalanche",avalancheDesc:t==="ru"?"Сначала высокий %":t==="uz"?"Avval yuqori %":"Highest interest first (save money)",extraPayment:t==="ru"?"Дополнительный платёж":t==="uz"?"Qo'shimcha to'lov":"Extra Payment",perMonth:t==="ru"?"в месяц":t==="uz"?"oyiga":"per month",totalDebt:t==="ru"?"Общий долг":t==="uz"?"Jami qarz":"Total Debt",payoffDate:t==="ru"?"Дата погашения":t==="uz"?"To'lash sanasi":"Payoff Date",interestSaved:t==="ru"?"Экономия на %":t==="uz"?"% bo'yicha tejash":"Interest Saved",order:t==="ru"?"Порядок погашения":t==="uz"?"To'lash tartibi":"Payoff Order",noDebts:t==="ru"?"Нет долгов":t==="uz"?"Qarzlar yo'q":"No debts",addDebts:t==="ru"?"Добавьте долги для симуляции":t==="uz"?"Simulyatsiya uchun qarz qo'shing":"Add debts for simulation",remaining:t==="ru"?"Остаток":t==="uz"?"Qoldiq":"Remaining",rate:t==="ru"?"Ставка":t==="uz"?"Stavka":"Rate",monthlyMin:t==="ru"?"Мин. платёж":t==="uz"?"Min. to'lov":"Min. Payment",timeline:t==="ru"?"График погашения":t==="uz"?"To'lash jadvali":"Payoff Timeline",addDebt:t==="ru"?"Добавить долг":t==="uz"?"Qarz qo'shish":"Add Debt",debtName:t==="ru"?"Название долга":t==="uz"?"Qarz nomi":"Debt Name",lender:t==="ru"?"Кредитор":t==="uz"?"Kreditor":"Lender",balance:t==="ru"?"Остаток долга":t==="uz"?"Qarz qoldig'i":"Balance",interestRate:t==="ru"?"Ставка (%)":t==="uz"?"Foiz stavkasi":"Interest Rate (%)",minPayment:t==="ru"?"Мин. платёж":t==="uz"?"Min. to'lov":"Min. Payment",save:t==="ru"?"Сохранить":t==="uz"?"Saqlash":"Save",months:t==="ru"?"мес":t==="uz"?"oy":"mo"},F=a=>{K(a),E.set("hamyon_debts",a)},X=()=>{if(!y||!g||!v||!w)return;const a={id:Date.now().toString(),name:y,lender:A||y,totalAmount:parseFloat(g),remainingAmount:parseFloat(g),interestRate:parseFloat(v),monthlyPayment:parseFloat(w),startDate:new Date().toISOString().slice(0,10),type:"loan"};F([...c,a]),f(!1),P(""),C(""),T(""),q(""),R(""),z("✓",!0)},Y=a=>{F(c.filter(i=>i.id!==a)),z("✓",!0)},O=l.useMemo(()=>{const a=[...c];return x==="snowball"?a.sort((i,j)=>i.remainingAmount-j.remainingAmount):a.sort((i,j)=>j.interestRate-i.interestRate)},[c,x]),m=l.useMemo(()=>{var B;if(c.length===0)return null;const a=parseFloat(D)||0,j=c.reduce((n,r)=>n+r.monthlyPayment,0)+a;let h=O.map(n=>({...n,balance:n.remainingAmount,paidOff:!1,payoffMonth:0})),o=0,k=0;const _=360,b=[];for(b.push({month:0,totalBalance:h.reduce((n,r)=>n+r.balance,0),label:"0"});h.some(n=>!n.paidOff)&&o<_;){o++;let n=j;h.forEach(r=>{if(r.paidOff)return;const u=r.interestRate/100/12*r.balance;r.balance+=u,k+=u;const Q=Math.min(r.monthlyPayment,r.balance);r.balance-=Q,n-=Q,r.balance<=.01&&(r.balance=0,r.paidOff=!0,r.payoffMonth=o)});for(const r of h){if(r.paidOff||n<=0)continue;const u=Math.min(n,r.balance);r.balance-=u,n-=u,r.balance<=.01&&(r.balance=0,r.paidOff=!0,r.payoffMonth=o);break}(o<=12||o%3===0)&&b.push({month:o,totalBalance:Math.max(0,h.reduce((r,u)=>r+u.balance,0)),label:o.toString()})}((B=b[b.length-1])==null?void 0:B.month)!==o&&b.push({month:o,totalBalance:0,label:o.toString()});let I=0;c.forEach(n=>{const r=Math.ceil(n.remainingAmount/n.monthlyPayment);I+=n.interestRate/100/12*n.remainingAmount*r*.5});const H=Math.max(0,I-k),S=new Date;return S.setMonth(S.getMonth()+o),{orderedDebts:h,totalMonths:o,payoffDate:S.toISOString().slice(0,7),interestSaved:H,totalInterestPaid:k,timelineData:b}},[O,D,c]),Z=c.reduce((a,i)=>a+i.remainingAmount,0);return e.jsxs("div",{className:"min-h-screen bg-background pb-32 px-4 pt-4",children:[e.jsxs("header",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>$("home"),className:"text-2xl",children:"←"}),e.jsx("h1",{className:"text-xl font-bold text-foreground",children:s.title})]}),e.jsx(d.button,{whileTap:{scale:.95},onClick:()=>f(!0),className:"p-2 rounded-full bg-primary text-primary-foreground",children:e.jsx(V,{className:"w-5 h-5"})})]}),c.length===0?e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(L,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"mb-2",children:s.noDebts}),e.jsx("p",{className:"text-sm",children:s.addDebts}),e.jsx("button",{onClick:()=>f(!0),className:"mt-4 px-6 py-3 bg-primary text-primary-foreground rounded-xl font-medium",children:s.addDebt})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-3",children:s.strategy}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(d.button,{whileTap:{scale:.98},onClick:()=>M("snowball"),className:`p-4 rounded-2xl border-2 text-left ${x==="snowball"?"border-primary bg-primary/10":"border-border bg-card"}`,children:[e.jsx(me,{className:`w-6 h-6 mb-2 ${x==="snowball"?"text-primary":"text-muted-foreground"}`}),e.jsx("p",{className:"font-semibold text-foreground",children:s.snowball}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.snowballDesc})]}),e.jsxs(d.button,{whileTap:{scale:.98},onClick:()=>M("avalanche"),className:`p-4 rounded-2xl border-2 text-left ${x==="avalanche"?"border-primary bg-primary/10":"border-border bg-card"}`,children:[e.jsx(ee,{className:`w-6 h-6 mb-2 ${x==="avalanche"?"text-primary":"text-muted-foreground"}`}),e.jsx("p",{className:"font-semibold text-foreground",children:s.avalanche}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.avalancheDesc})]})]})]}),e.jsxs("section",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s.extraPayment}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",value:D,onChange:a=>G(a.target.value),placeholder:"0",className:"flex-1 p-3 rounded-xl bg-secondary border border-border text-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:s.perMonth})]})]}),m&&e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-2xl bg-expense/10 border border-expense/20",children:[e.jsx(L,{className:"w-5 h-5 text-expense mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.totalDebt}),e.jsx("p",{className:"text-lg font-bold text-expense",children:N(Z,p)})]}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-4 rounded-2xl bg-primary/10 border border-primary/20",children:[e.jsx(te,{className:"w-5 h-5 text-primary mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.payoffDate}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:m.payoffDate})]}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-4 rounded-2xl bg-income/10 border border-income/20",children:[e.jsx(ae,{className:"w-5 h-5 text-income mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.interestSaved}),e.jsx("p",{className:"text-lg font-bold text-income",children:N(m.interestSaved,p)})]})]}),m&&m.timelineData.length>1&&e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"p-4 rounded-2xl bg-card border border-border mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:s.timeline}),e.jsx("div",{className:"h-48",children:e.jsx(re,{width:"100%",height:"100%",children:e.jsxs(ne,{data:m.timelineData,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"debtGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(var(--expense))",stopOpacity:.4}),e.jsx("stop",{offset:"100%",stopColor:"hsl(var(--expense))",stopOpacity:0})]})}),e.jsx(oe,{dataKey:"label",axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:10},interval:"preserveStartEnd"}),e.jsx(le,{hide:!0}),e.jsx(ie,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"12px",padding:"8px 12px"},labelStyle:{color:"hsl(var(--foreground))"},formatter:a=>[N(a,p),s.remaining],labelFormatter:a=>`${a} ${s.months}`}),e.jsx(de,{type:"monotone",dataKey:"totalBalance",stroke:"hsl(var(--expense))",strokeWidth:2,fill:"url(#debtGradient)"})]})})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-3",children:s.order}),e.jsx("div",{className:"space-y-3",children:m==null?void 0:m.orderedDebts.map((a,i)=>e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:i*.05},className:"p-4 rounded-2xl bg-card border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold",children:i+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-foreground",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.lender})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-foreground",children:N(a.remainingAmount,p)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.interestRate,"% ",s.rate]})]}),e.jsx("button",{onClick:()=>Y(a.id),className:"p-2 rounded-lg bg-destructive/10 text-destructive",children:e.jsx(ce,{className:"w-4 h-4"})})]}),a.payoffMonth>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-border flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.monthlyMin,": ",N(a.monthlyPayment,p)]}),e.jsxs("span",{className:"text-income font-medium",children:[t==="ru"?"Погашен через":t==="uz"?"To'lanadi":"Paid off in"," ",a.payoffMonth," ",s.months]})]})]},a.id))})]})]}),J&&e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",onClick:()=>f(!1),children:e.jsxs(d.div,{initial:{y:"100%"},animate:{y:0},onClick:a=>a.stopPropagation(),className:"bg-background rounded-t-3xl p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:s.addDebt}),e.jsx("button",{onClick:()=>f(!1),className:"p-2",children:e.jsx(se,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s.debtName}),e.jsx("input",{type:"text",value:y,onChange:a=>P(a.target.value),placeholder:"Credit Card, Auto Loan...",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s.lender}),e.jsx("input",{type:"text",value:A,onChange:a=>C(a.target.value),placeholder:"Bank, Company...",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s.balance}),e.jsx("input",{type:"number",value:g,onChange:a=>T(a.target.value),placeholder:"0",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s.interestRate}),e.jsx("input",{type:"number",step:"0.1",value:v,onChange:a=>q(a.target.value),placeholder:"15",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:s.minPayment}),e.jsx("input",{type:"number",value:w,onChange:a=>R(a.target.value),placeholder:"0",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]})]}),e.jsx(d.button,{whileTap:{scale:.98},onClick:X,disabled:!y||!g||!v||!w,className:"w-full p-4 rounded-xl bg-primary text-primary-foreground font-bold disabled:opacity-50",children:s.save})]})]})})]})});export{be as DebtPayoffScreen,be as default};
