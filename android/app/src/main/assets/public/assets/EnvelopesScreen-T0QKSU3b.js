import{r as n,u as Y,g as N,j as e,a as i,P as H,p as u,z as Q,A as X,X as G,h as U}from"./index-Bngez1jy.js";import{W as Z}from"./wallet-M4D0BMYY.js";import{T as ee}from"./trash-2-DgMVlkGx.js";const F=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"],te=["ðŸ ","ðŸ”","ðŸš—","ðŸŽ¬","ðŸ›’","ðŸ’Š","âœˆï¸","ðŸ“š","ðŸ’°","ðŸŽ"],re=n.memo(()=>{const{lang:s,currency:c,showToast:A,setActiveScreen:_,transactions:O,allCats:L,catLabel:P,getCat:J}=Y(),[$,v]=n.useState(()=>N.get("hamyon_envelopes",[])),[W,m]=n.useState(!1),[p,D]=n.useState(null),[g,w]=n.useState(""),[I,k]=n.useState("ðŸ’°"),[h,C]=n.useState(""),[f,S]=n.useState([]),[B,E]=n.useState(F[0]),[z,b]=n.useState("monthly"),r={title:s==="ru"?"ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ñ‹ Ð±ÑŽÐ´Ð¶ÐµÑ‚Ð°":s==="uz"?"Byudjet konvertlari":"Budget Envelopes",addNew:s==="ru"?"ÐÐ¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚":s==="uz"?"Yangi konvert":"New Envelope",name:s==="ru"?"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ":s==="uz"?"Nomi":"Name",allocated:s==="ru"?"Ð’Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¾":s==="uz"?"Ajratilgan":"Allocated",spent:s==="ru"?"ÐŸÐ¾Ñ‚Ñ€Ð°Ñ‡ÐµÐ½Ð¾":s==="uz"?"Sarflangan":"Spent",remaining:s==="ru"?"ÐžÑÑ‚Ð°Ð»Ð¾ÑÑŒ":s==="uz"?"Qoldi":"Remaining",categories:s==="ru"?"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸":s==="uz"?"Kategoriyalar":"Categories",period:s==="ru"?"ÐŸÐµÑ€Ð¸Ð¾Ð´":s==="uz"?"Davr":"Period",weekly:s==="ru"?"ÐÐµÐ´ÐµÐ»Ñ":s==="uz"?"Haftalik":"Weekly",monthly:s==="ru"?"ÐœÐµÑÑÑ†":s==="uz"?"Oylik":"Monthly",save:s==="ru"?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ":s==="uz"?"Saqlash":"Save",noEnvelopes:s==="ru"?"ÐÐµÑ‚ ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð¾Ð²":s==="uz"?"Konvertlar yo'q":"No envelopes",totalAllocated:s==="ru"?"Ð’ÑÐµÐ³Ð¾ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¾":s==="uz"?"Jami ajratilgan":"Total Allocated",totalSpent:s==="ru"?"Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ñ‚Ñ€Ð°Ñ‡ÐµÐ½Ð¾":s==="uz"?"Jami sarflangan":"Total Spent"},y=n.useMemo(()=>{const t=new Date,l=a=>{if(a==="weekly"){const o=new Date(t);return o.setDate(t.getDate()-t.getDay()),o.toISOString().slice(0,10)}else return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`};return $.map(a=>{const o=l(a.period),x=O.filter(d=>d.amount<0&&d.date>=o&&a.categoryIds.includes(d.categoryId)).reduce((d,j)=>d+Math.abs(j.amount),0);return{...a,spent:x}})},[$,O]),T=n.useMemo(()=>y.reduce((t,l)=>({allocated:t.allocated+l.allocated,spent:t.spent+l.spent}),{allocated:0,spent:0}),[y]),M=()=>{w(""),k("ðŸ’°"),C(""),S([]),E(F[0]),b("monthly"),D(null)},R=t=>{w(t.name),k(t.emoji),C(t.allocated.toString()),S(t.categoryIds),E(t.color),b(t.period),D(t.id),m(!0)},q=t=>{S(l=>l.includes(t)?l.filter(a=>a!==t):[...l,t])},K=()=>{if(!g.trim()||!h||f.length===0)return;const t={id:p||U(),name:g.trim(),emoji:I,allocated:parseFloat(h),spent:0,categoryIds:f,color:B,period:z};v(p?l=>{const a=l.map(o=>o.id===p?t:o);return N.set("hamyon_envelopes",a),a}:l=>{const a=[t,...l];return N.set("hamyon_envelopes",a),a}),A("âœ“",!0),m(!1),M()},V=t=>{v(l=>{const a=l.filter(o=>o.id!==t);return N.set("hamyon_envelopes",a),a}),A("âœ“",!0)};return e.jsxs("div",{className:"min-h-screen bg-background pb-32 px-4 pt-4",children:[e.jsxs("header",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>_("home"),className:"text-2xl",children:"â†"}),e.jsx("h1",{className:"text-xl font-bold text-foreground",children:r.title})]}),e.jsx(i.button,{whileTap:{scale:.95},onClick:()=>{M(),m(!0)},className:"p-2 rounded-full bg-primary text-primary-foreground",children:e.jsx(H,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-2xl bg-gradient-to-br from-primary/20 to-primary/5 border border-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Z,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r.totalAllocated})]}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:u(T.allocated,c)})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-4 rounded-2xl bg-gradient-to-br from-expense/20 to-expense/5 border border-expense/20",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:r.totalSpent}),e.jsx("p",{className:"text-xl font-bold text-expense",children:u(T.spent,c)})]})]}),y.length===0?e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx("span",{className:"text-4xl block mb-3",children:"âœ‰ï¸"}),e.jsx("p",{children:r.noEnvelopes})]}):e.jsx("div",{className:"space-y-4",children:y.map((t,l)=>{const a=t.allocated-t.spent,o=t.allocated>0?t.spent/t.allocated*100:0,x=o>=100;return e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"p-4 rounded-2xl bg-card border border-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:`${t.color}20`},children:t.emoji}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:t.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.categoryIds.length," ",r.categories.toLowerCase()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`font-bold ${x?"text-expense":"text-foreground"}`,children:u(a,c)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.remaining})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-muted-foreground",children:[u(t.spent,c)," / ",u(t.allocated,c)]}),e.jsxs("span",{className:x?"text-expense":"text-foreground",children:[o.toFixed(0),"%"]})]}),e.jsx("div",{className:"h-3 bg-secondary rounded-full overflow-hidden",children:e.jsx(i.div,{className:"h-full rounded-full",style:{backgroundColor:x?"hsl(var(--expense))":t.color},initial:{width:0},animate:{width:`${Math.min(o,100)}%`},transition:{duration:.8}})})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[t.categoryIds.slice(0,4).map(d=>{const j=J(d);return e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-secondary",children:[j.emoji," ",P(j)]},d)}),t.categoryIds.length>4&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-secondary",children:["+",t.categoryIds.length-4]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-border",children:[e.jsx("button",{onClick:()=>R(t),className:"p-2 rounded-lg bg-secondary text-foreground",children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(t.id),className:"p-2 rounded-lg bg-destructive/20 text-destructive",children:e.jsx(ee,{className:"w-4 h-4"})})]})]},t.id)})}),e.jsx(X,{children:W&&e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",onClick:()=>m(!1),children:e.jsxs(i.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:t=>t.stopPropagation(),className:"bg-background rounded-t-3xl p-6 w-full max-w-lg max-h-[85vh] overflow-y-auto",style:{paddingBottom:"calc(1.5rem + 80px + env(safe-area-inset-bottom))"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:p?r.save:r.addNew}),e.jsx("button",{onClick:()=>m(!1),className:"p-2",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Emoji"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:te.map(t=>e.jsx("button",{onClick:()=>k(t),className:`p-2 rounded-lg text-xl ${I===t?"bg-primary/20 ring-2 ring-primary":"bg-secondary"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Color"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:F.map(t=>e.jsx("button",{onClick:()=>E(t),className:`w-8 h-8 rounded-full ${B===t?"ring-2 ring-primary ring-offset-2":""}`,style:{backgroundColor:t}},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r.name}),e.jsx("input",{type:"text",value:g,onChange:t=>w(t.target.value),placeholder:"Food, Transport...",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r.allocated}),e.jsx("input",{type:"number",value:h,onChange:t=>C(t.target.value),placeholder:"0",className:"w-full p-3 rounded-xl bg-secondary border border-border text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r.period}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b("weekly"),className:`flex-1 p-3 rounded-xl ${z==="weekly"?"bg-primary text-primary-foreground":"bg-secondary"}`,children:r.weekly}),e.jsx("button",{onClick:()=>b("monthly"),className:`flex-1 p-3 rounded-xl ${z==="monthly"?"bg-primary text-primary-foreground":"bg-secondary"}`,children:r.monthly})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r.categories}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-40 overflow-y-auto",children:L.expense.map(t=>e.jsxs("button",{onClick:()=>q(t.id),className:`px-3 py-2 rounded-lg text-sm flex items-center gap-1 ${f.includes(t.id)?"bg-primary text-primary-foreground":"bg-secondary text-foreground"}`,children:[e.jsx("span",{children:t.emoji}),e.jsx("span",{children:P(t)})]},t.id))})]}),e.jsx(i.button,{whileTap:{scale:.98},onClick:K,disabled:!g.trim()||!h||f.length===0,className:"w-full p-4 rounded-xl bg-primary text-primary-foreground font-bold disabled:opacity-50",children:r.save})]})]})})})]})});export{re as EnvelopesScreen,re as default};
